function [f1, f2, f3, u_1, u_2, u_3, Potential, ...
            TotalStrain_11, TotalStrain_12, TotalStrain_13, ...
            TotalStrain_22, TotalStrain_23, TotalStrain_33, ...
            E_1_depol, E_2_depol, E_3_depol] = ...
        CalcEnergies(P1, P2, P3, Constants, ...
        Green_11, Green_12, Green_13, ...
        Green_21, Green_22, Green_23, ...
        Green_31, Green_32, Green_33, ...
        strain_bc_mats_inv, strain_bc_mat_inv_korigin, ...
        electric_bc_mats_inv, electric_bc_mats_inv_korigin, ...
        kx_grid_3D, ky_grid_3D, kz_grid_3D, z_axis, ...
        strain_sol_2Dk_1, strain_sol_2Dk_2, strain_sol_2Dk_3, ...
        strain_sol_2Dk_4, strain_sol_2Dk_5, strain_sol_2Dk_6, ...
        strain_sol_2Dk_d3_1, strain_sol_2Dk_d3_2, strain_sol_2Dk_d3_3, ...
        strain_sol_2Dk_d3_4, strain_sol_2Dk_d3_5, strain_sol_2Dk_d3_6, ...
        potential_2Dk_sol_1, potential_2Dk_sol_2, ...
        potential_2Dk_d3_sol_1, potential_2Dk_d3_sol_2, ...
        strain_bc_mats_L_inv_lu, strain_bc_mats_U_lu, strain_bc_mats_P_lu)

    %% Energies
    [f1_elastic, f2_elastic, f3_elastic, u_1, u_2, u_3,...
        TotalStrain_11, TotalStrain_12, TotalStrain_13, ...
        TotalStrain_22, TotalStrain_23, TotalStrain_33] = CalcElasticEnergy(P1, P2, P3, Constants, ...
                                                            Green_11, Green_12, Green_13, ...
                                                            Green_21, Green_22, Green_23, ...
                                                            Green_31, Green_32, Green_33, ...
                                                            strain_bc_mats_inv, strain_bc_mat_inv_korigin, ...
                                                            kx_grid_3D, ky_grid_3D, kz_grid_3D, z_axis, ...
                                                            strain_sol_2Dk_1, strain_sol_2Dk_2, strain_sol_2Dk_3, ...
                                                            strain_sol_2Dk_4, strain_sol_2Dk_5, strain_sol_2Dk_6, ...
                                                            strain_sol_2Dk_d3_1, strain_sol_2Dk_d3_2, strain_sol_2Dk_d3_3, ...
                                                            strain_sol_2Dk_d3_4, strain_sol_2Dk_d3_5, strain_sol_2Dk_d3_6, ...
                                                            strain_bc_mats_L_inv_lu, strain_bc_mats_U_lu, strain_bc_mats_P_lu);
        
    [f1_elec, f2_elec, f3_elec, Potential, ...
    E_1_depol, E_2_depol, E_3_depol] = CalcElecEnergy(P1, P2, P3, Constants, ...
                                                    electric_bc_mats_inv, electric_bc_mats_inv_korigin, ...
                                                    kx_grid_3D, ky_grid_3D, kz_grid_3D, z_axis, ...
                                                    potential_2Dk_sol_1, potential_2Dk_sol_2, ...
                                                    potential_2Dk_d3_sol_1, potential_2Dk_d3_sol_2);

    [Thermal_Noise_1, Thermal_Noise_2, Thermal_Noise_3] = ThermalNoise(Constants);
    
    a1 = Constants.a1;
    a11 = Constants.a11;
    a12 = Constants.a12;
    a111 = Constants.a111;
    a112 = Constants.a112;
    a123 = Constants.a123;
    a1111 = Constants.a1111;
    a1112 = Constants.a1112;
    a1122 = Constants.a1122;
    a1123 = Constants.a1123;
    
    %% Landau Free Energy
    f1_landau = ( P1 .* ( ...
        2 .* a1 + 4 .* a11 .* P1.^2 + 2 .* a12 .* ( P2.^2 + P3.^2 ) + ...
        6 .* a111 .* P1.^4 + 2 .* a112 .* ( P2.^4 + P3.^4 + 2 .* P1.^2 .* ( P2.^2 + P3.^2 ) ) + ...
        2 .* a123 .* P2.^2 .* P3.^2 + ...
        8 .* a1111 .* P1.^6 + 2 .* a1112.* ( P2.^6 + P3.^6 + 3 .* P1.^4 .* ( P2.^2 + P3.^2 ) ) + ...
        4 .* a1122 .* P1.^2 .* ( P2.^4 + P3.^4 ) + ...
        2 .* a1123 .* ( 2 .* P1.^2 .* P2.^2 .* P3.^2 + P2.^2 .* P3.^2 .* ( P2.^2 + P3.^2 ) ) ) );

    f2_landau = ( P2 .* ( ...
        2 .* a1 + 4 .* a11 .* P2.^2 + 2 .* a12 .* ( P3.^2 + P1.^2 ) + ...
        6 .* a111 .* P2.^4 + 2 .* a112 .* ( P3.^4 + P1.^4 + 2 .* P2.^2 .* ( P3.^2 + P1.^2 ) ) + ...
        2 .* a123 .* P3.^2 .* P1.^2 + ...
        8 .* a1111 .* P2.^6 + 2 .* a1112.* ( P3.^6 + P1.^6 + 3 .* P2.^4 .* ( P3.^2 + P1.^2 ) ) + ...
        4 .* a1122 .* P2.^2 .* ( P3.^4 + P1.^4 ) + ...
        2 .* a1123 .* ( 2 .* P2.^2 .* P3.^2 .* P1.^2 + P3.^2 .* P1.^2 .* ( P3.^2 + P1.^2 ) ) ) );

    f3_landau = ( P3 .* ( ...
        2 .* a1 + 4 .* a11 .* P3.^2 + 2 .* a12 .* ( P1.^2 + P2.^2 ) + ...
        6 .* a111 .* P3.^4 + 2 .* a112 .* ( P1.^4 + P2.^4 + 2 .* P3.^2 .* ( P1.^2 + P2.^2 ) ) + ...
        2 .* a123 .* P1.^2 .* P2.^2 + ...
        8 .* a1111 .* P3.^6 + 2 .* a1112.* ( P1.^6 + P2.^6 + 3 .* P3.^4 .* ( P1.^2 + P2.^2 ) ) + ...
        4 .* a1122 .* P3.^2 .* ( P1.^4 + P2.^4 ) + ...
        2 .* a1123 .* ( 2 .* P3.^2 .* P1.^2 .* P2.^2 + P1.^2 .* P2.^2 .* ( P1.^2 + P2.^2 ) ) ) );
        
    f1_ext_E = -Constants.E_1_applied;
    f2_ext_E = -Constants.E_2_applied;
    f3_ext_E = -Constants.E_3_applied;

    f1 = f1_landau + f1_elec + f1_elastic + f1_ext_E + Thermal_Noise_1;
    f2 = f2_landau + f2_elec + f2_elastic + f2_ext_E + Thermal_Noise_2;
    f3 = f3_landau + f3_elec + f3_elastic + f3_ext_E + Thermal_Noise_3;

    in_film = Constants.in_film;
    
    f1 = f1 .* in_film;
    f2 = f2 .* in_film;
    f3 = f3 .* in_film;
    
end